<div class="row">
    <h4 class="header"><%= @post.title %></h4>
  <div class="col s12">
    <div class="card horizontal">
      <div class="card-stacked">
        <div class="card-content">
          <p>Written by: <%= link_to "#{@post.author.username}", user_path(@post.author.id) %></p>
          <p id='post-text'><%= @post.text %></p>
          <% if logged_in? && voted?(@post) %>
              <%= link_to post_votes_path(@post), method: 'CREATE', class: 'secondary-content' do %>
                  <i class="material-icons">thumb_up</i>
              <% end %>
          <% end %>
        </div>
        <div class="card-action">
          <% if logged_in? %>
              <%= link_to "Add a comment", new_post_comment_path(@post) %>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="col s12 center-align">
    <div id="tweet-container" class="btn btn-success clearfix">
      <a id="twitter-share-button"
        href="https://twitter.com/share"
        data-size="large"
        data-text="Check out this website"
        data-url="https://dev.twitter.com/web/tweet-button"
        data-hashtags="ghostwirter"
        data-via="twitterdev"
        data-related="twitterapi,twitter">
      </a>
      Share on Twitter
    </div>

    <div id="shareBtn" class="btn btn-success clearfix">Share on Facebook</div>
  </div>
</div>


<div class="row">
    <div class="col s12">
      <% if @post.comments %>
        <ul class="collection with-header">
            <li class="collection-header"><h4>Comments</h4></li>
          <% @post.comments.each do |comment| %>
            <li class="collection-item">
                <span class="secondary-content"><%= comment.votes.count %> votes</span>
              <div>
                <h5><%= comment.commenter.username %></h5>
                <%= comment.body %>
              </div>

              <div class="right-align">
                <% if authorized?(comment.commenter_id) %>
                    <%= link_to post_comment_path(@post,comment), method: 'DELETE', class: "btn-floating btn-small waves-effect waves-light red" do %>
                        <i class="material-icons">delete</i>
                    <% end %>
                <% end %>

                <% if voted?(comment) && logged_in? %>
                    <%= link_to comment_votes_path(comment), method: 'CREATE', class: "btn-floating btn-small waves-effect waves-light red" do %>
                        <i class="material-icons">thumb_up</i>
                    <% end %>
                <% end %>
              </div>

            </li>
          <% end %>
        </ul>
      <% end %>
    </div>
</div>

<div class="row">
  <% if author?(@post) %>
      <div class="fixed-action-btn toolbar">
        <a class="btn-floating btn-large red pulse">
          <i class="large material-icons">menu</i>
        </a>
        <ul>
          <li>
            <%= link_to edit_post_path(@post), class: 'waves-effect waves-light tooltipped' do %>
              <i class="material-icons tooltipped" data-position="top" data-delay="10" data-tooltip="Edit Post">mode_edit</i>
            <% end %>
          </li>

          <li>
            <%= link_to post_path(@post), method: "DELETE", class: 'waves-effect waves-light' do %>
              <i class="material-icons tooltipped" data-position="top" data-delay="10" data-tooltip="Delete Post">delete</i>
            <% end %>
          </li>

          <% if !@post.published? && author?(@post) %>
              <li>
                <%= link_to post_path(:id => @post.id, :posts => { :published? => true}), method: 'PUT', class: 'waves-effect waves-light' do %>
                    <i class="material-icons tooltipped" data-position="top" data-delay="10" data-tooltip="Publish Post">playlist_add</i>
                <% end %>
              </li>


          <% elsif @post.published? && author?(@post) %>
              <li>
                <%= link_to post_path(:id => @post.id, :posts => { :published? => false}), method: 'PUT', class: 'waves-effect waves-light' do %>
                    <i class="material-icons tooltipped" data-position="top" data-delay="10" data-tooltip="Un-publish Post">not_interested</i>
                <% end %>
              </li>
          <% end %>
        </ul>
      </div>
  <% end %>
</div>